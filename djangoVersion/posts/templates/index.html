{% load static %}

<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>My Web App</title>
  <link rel="stylesheet" href="{% static 'sell-platform.css' %}">
</head>
<body style="background-color: #faeccd;">
    
    <header class="header-container1">
        <div class="header-links1">
            <a href="#" class="header-link1" style="margin-left: 40px;">語言</a>
            <a href="#" class="header-link1">登入</a>
            <a href="#" class="header-link1">註冊</a>
        </div>
    </header>
    <header class="header-container2">

        <h1 class="header-logo">出清台大2.0</h1>
        <div class="header-links2">
            <a href="../homePage/mainPage.html" class="header-link2" style="margin-left: 150px;">主頁</a>
            <a href="#" class="header-link2">活動區</a>
            <a href="#" class="header-link2">二手物品交易區</a>
            <a href="#" class="header-link2" style="margin-right: 190px;">聊天室</a>
        </div>
        <div class="header-links1">
            <div class="search-bar">
                <input type="text" placeholder="搜尋...">
            </div>
        </div>
    </div>
    </header>

    <hr style="border: 0.1px solid black; margin: 0;">

    <!-- 按鈕 -->
    <button id="sell-button">我要販賣物品</button>

    <div id="sell-form">
        <h2>販賣物品</h2>
        <form method="post" action="{% url 'add_item' %}" enctype="multipart/form-data"> 
            {% csrf_token %}
            <label>物品名稱：
                <input type="text" id="item-name" name="name" required>
            </label>

            <label>價格：
                <input type="number" id="item-price" name="price" required>
            </label>

            <label>交易方式：</label>
            <select id="item-transaction" name="transaction_type">
                <option value="僅面交">僅面交</option>
                <option value="僅寄送">僅寄送</option>
                <option value="面交、寄送皆可">面交、寄送皆可</option>
            </select>

            <label>面交地點：
                <input type="text" id="item-location" name="transaction_location">
            </label>

            <label>數量：
                <input type="number" id="item-quantity" name="quantity" required>
            </label>

            <label>分類：</label>
            <select id="item-category" name="category">
                <option value="衣物">衣物</option>
                <option value="鞋子">鞋子</option>
                <option value="3C">3C</option>
                <option value="其他">其他</option>
            </select>

            <label>商品狀況：
                <input type="text" id="item-condition" name="condition" required>
            </label>

            <label>上傳圖片：
                <input type="file" id="item-image" accept="image/*" name="image" required>
            </label>

            <div>
            <button type="button" id="cancel-button">取消</button>
            <button type="submit" id="sell-submit-button" value="Post">販賣</button>
            </div>
        </form>
    </div>

    
    <!-- 商品類別 -->
    <div class="categories">
        <ul>
            <li class="{% if not category %}active{% endif %}">
                <a href="{% url 'item_list' %}" onclick="location.href=this.href;">全部</a>
            </li>
            <li class="{% if category == '衣物' %}active{% endif %}">
                <a href="{% url 'item_list_by_category' '衣物' %}" onclick="location.href=this.href;">衣物</a>
            </li>
            <li class="{% if category == '鞋子' %}active{% endif %}">
                <a href="{% url 'item_list_by_category' '鞋子' %}" onclick="location.href=this.href;">鞋子</a>
            </li>
            <li class="{% if category == '3C' %}active{% endif %}">
                <a href="{% url 'item_list_by_category' '3C' %}" onclick="location.href=this.href;">3C</a>
            </li>
            <li class="{% if category == '其他' %}active{% endif %}">
                <a href="{% url 'item_list_by_category' '其他' %}" onclick="location.href=this.href;">其他</a>
            </li>
        </ul>
    </div>

    <div id="item-container">
        {% for item in items %}
            <div class="newItem">
                <div class="item-image-container">
                    <img src="{{ item.image.url }}" alt="{{ item.name }}"></img>
                </div>
                <div class="item-text-container">
                    <h3>{{ item.name }}</h3>
                    <p>＄{{ item.price }}</p>
                    <button class="item-details-button" data-item-id="{{ item.item_id }}">詳細資訊</button>
                </div>
                {% comment %} <div class="item-details-wrapper"> {% endcomment %}
                    <div class="item-details-container">
                        <!-- 商品詳細資訊 -->
                        <div class="item-details-image">
                            <img src="{{ item.image.url }}" alt="{{ item.name }}" />
                        </div>
                        <div class="item-details-text">
                            <h2>{{ item.name }}</h3>
                            <h3>＄{{ item.price }}</p>
                            <p>數量：{{ item.quantity }}</p>
                            <p>分類：{{ item.category }}</p>
                            <p>交易方式：{{ item.transaction_type }}</p>
                            <p>面交地點：{{ item.transaction_location }}</p>
                            <p>商品狀況：{{ item.condition }}</p>
                        </div>

                        <label>留言板：</label>
                        <form method="post" action="{% url 'item_detail' item_id=item.pk %}" id="comment-form">
                            {% csrf_token %}
                            <textarea id="comment-input" name="comment" rows="5" cols="50"></textarea>
                            <br>
                            <button type="submit" id="comment-submit-button">留言</button>
                        </form>
                    
                        <div class="comments">
                            {% for comment in comments %}
                                <div class="comment">
                                    <p>{{ comment.content }}</p>
                                    <p>{{ comment.created_at }}</p>
                                </div>
                            {% empty %}
                                <p>目前還沒有。</p>
                            {% endfor %}
                        </div>
                    
                        <button class="close-button">X</button>
                        
                    </div>
                {% comment %} </div> {% endcomment %}
            </div>
        {% endfor %}
    </div>
    
    <script src="{% static 'sell-item.js' %}"></script>
    <script src="{% static 'item-detail.js' %}?v=1"></script>
</body>
</html>